/*! jquery asSpinner - v0.2.0 - 2014-05-28
* https://github.com/amazingSurge/jquery-asSpinner
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a){var b=a.asSpinner=function(c,d){if(this.element=c,this.$element=a(c),this.options=a.extend({},b.defaults,d,this.$element.data()),this.namespace=this.options.namespace,this.options.rule){var e=this,f=["min","max","step","precision"];a.each(f,function(a,c){e[c]=b.rules[e.options.rule][c]})}else this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.precision=this.options.precision;this.disabled=this.options.disabled,this.$element.prop("disabled")&&(this.disabled=!0),this.value=this.isNumber(this.$element.val())?this.$element.val():null,this.mousewheel=this.options.mousewheel,this.mousewheel&&!a.event.special.mousewheel&&(this.mousewheel=!1),this.eventBinded=!1,this.spinTimeout=null,this.isFocused=!1,this.classes={disabled:this.namespace+"_disabled",skin:this.namespace+"_"+this.options.skin,focus:this.namespace+"_focus",control:this.namespace+"-control",down:this.namespace+"-down",up:this.namespace+"-up",wrap:this.namespace},this._trigger("init"),this.init()};b.prototype={constructor:b,init:function(){this.$control=a('<div class="'+this.namespace+'-control"><span class="'+this.classes.down+'"></span><span class="'+this.classes.up+'"></span></div>'),this.$wrap=this.$element.wrap('<div tabindex="0" class="'+this.classes.wrap+'"></div>').parent(),this.$down=this.$control.find("."+this.classes.down),this.$up=this.$control.find("."+this.classes.up),this.options.skin&&this.$wrap.addClass(this.classes.skin),this.$control.appendTo(this.$wrap),this.disabled===!1?this.bindEvent():this.disable(),this.set(this.value,this.options.format),this._trigger("ready")},_trigger:function(a){this.$element.trigger("asSpinner::"+a,this),this.$element.trigger(a+".asSpinner",this),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var b="on"+a,c=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;"function"==typeof this.options[b]&&this.options[b].apply(this,c)},spin:function(a,b){var c=this,d=function(b){clearTimeout(c.spinTimeout),c.spinTimeout=setTimeout(function(){a.call(c),d(60)},b)};d(b||500)},_focus:function(){this.isFocused||this.$element.focus()},bindEvent:function(){var b=this;this.eventBinded=!0,this.$down.on("mousedown.asSpinner",function(){return b._focus(),b.spin(b.spinDown),!1}).on("mouseup.asSpinner",function(){return clearTimeout(b.spinTimeout),b.spinDown.call(b),!1}),this.$up.on("mousedown.asSpinner",function(){return b._focus(),b.spin(b.spinUp),!1}).on("mouseup.asSpinner",function(){return clearTimeout(b.spinTimeout),!1}).on("click.asSpinner",function(){return b.spinUp.call(b),!1}),this.$element.on("focus.asSpinner",function(){var c=a.trim(b.$element.val());return c="function"==typeof b.options.parse?b.options.parse(c):parseFloat(c),b._set(c),!1}).on("blur.asSpinner",function(){return b.set(b.value,b.options.format),!1}),this.$wrap.on("blur.asSpinner",function(){return b.set(b.value),b.$wrap.removeClass(b.classes.focus),!1}).on("click.asSpinner",function(){return b.$wrap.addClass(b.classes.focus),!1}),this.$element.on("focus.asSpinner",function(){b.isFocused=!0,a(this).on("keydown.asSpinner",function(a){var c=a.keyCode||a.which,d=this;return 38===c?(b.spinUp.call(b),!1):40===c?(b.spinDown.call(b),!1):void(57>=c&&c>=48&&setTimeout(function(){b.set(parseFloat(d.value))},0))}),b.mousewheel===!0&&a(this).mousewheel(function(a,c){c>0?b.spinUp():b.spinDown(),a.spinDownentDefault()})}).on("blur.asSpinner",function(){b.isFocused=!1,a(this).off("keydown.asSpinner"),b.$wrap.removeClass(b.classes.focus),b.mousewheel===!0&&b.$element.unmousewheel()})},unbindEvent:function(){this.eventBinded=!1,this.$element.off("focus.asSpinner").off("blur.asSpinner").off("keydown.asSpinner"),this.$down.off("click.asSpinner").off("mousedown.asSpinner").off("mouseup.asSpinner"),this.$up.off("click.asSpinner").off("mousedown.asSpinner").off("mouseup.asSpinner"),this.$wrap.off("blur.asSpinner").off("click.asSpinner")},isNumber:function(b){return"number"==typeof b&&a.isNumeric(b)?!0:!1},isOutOfBounds:function(a){return a<this.min?-1:a>this.max?1:0},_set:function(a,b){isNaN(a)&&(a=this.min);var c=this.isOutOfBounds(a);0!==c&&(a=this.options.looping===!0?1===c?this.min:this.max:-1===c?this.min:this.max),this.value=a=Number(a).toFixed(this.precision),"function"==typeof b&&(a=b(a)),this.$element.val(a)},set:function(a,b){this._set(a,b),this._trigger("change")},get:function(){return this.value},update:function(a){var b=this;["min","max","precision","step"].map(function(c){a[c]&&(b[c]=a[c])}),a.value&&this.set(a.value)},val:function(a){return a?void this.set(a):this.get()},spinDown:function(){return a.isNumeric(this.value)||(this.value=0),this.value=parseFloat(this.value)-parseFloat(this.step),this._set(this.value),this},spinUp:function(){return a.isNumeric(this.value)||(this.value=0),this.value=parseFloat(this.value)+parseFloat(this.step),this._set(this.value),this},enable:function(){return this.disabled=!1,this.$wrap.removeClass(this.classes.disabled),this.$element.prop("disabled",!1),this.eventBinded===!1&&this.bindEvent(),this},disable:function(){return this.disabled=!0,this.$element.prop("disabled",!0),this.$wrap.addClass(this.classes.disabled),this.unbindEvent(),this},destroy:function(){this.unbindEvent()}},b.rules={defaults:{min:null,max:null,step:1,precision:0},currency:{min:0,max:99999,step:.01,precision:2},quantity:{min:1,max:999,step:1,precision:0},percent:{min:1,max:100,step:1,precision:0},month:{min:1,max:12,step:1,precision:0},day:{min:1,max:31,step:1,precision:0},hour:{min:0,max:23,step:1,precision:0},minute:{min:1,max:59,step:1,precision:0},second:{min:1,max:59,step:1,precision:0}},b.defaults={namespace:"asSpinner",skin:null,disabled:!1,min:-10,max:10,step:1,name:null,precision:0,rule:null,looping:!1,mousewheel:!1,format:null,parse:null},a.fn.asSpinner=function(c){if("string"!=typeof c)return this.each(function(){a.data(this,"asSpinner")||a.data(this,"asSpinner",new b(this,c))});var d=c,e=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;if(/^\_/.test(d))return!1;if(!(/^(get)$/.test(d)||"val"===d&&void 0===e))return this.each(function(){var b=a.data(this,"asSpinner");b&&"function"==typeof b[d]&&b[d].apply(b,e)});var f=this.first().data("asSpinner");return f&&"function"==typeof f[d]?f[d].apply(f,e):void 0}}(jQuery);